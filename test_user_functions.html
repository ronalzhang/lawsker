<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·åŠŸèƒ½æŒ‰é’®æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .test-button { margin: 5px; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; }
        .btn-primary { background: #007bff; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; max-width: 500px; width: 90%; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ç”¨æˆ·å·¥ä½œå°åŠŸèƒ½æŒ‰é’®æµ‹è¯•</h1>
    
    <div class="test-section">
        <h3>æµ‹è¯•åŠŸèƒ½æŒ‰é’®</h3>
        <button class="test-button btn-primary" onclick="testViewTaskDetails()">æµ‹è¯•æŸ¥çœ‹è¯¦æƒ…</button>
        <button class="test-button btn-secondary" onclick="testEditTask()">æµ‹è¯•ç¼–è¾‘ä»»åŠ¡</button>
        <button class="test-button btn-primary" onclick="testContactExchange()">æµ‹è¯•äº¤æ¢è”ç³»æ–¹å¼</button>
    </div>
    
    <div id="testResults"></div>
    
    <!-- è”ç³»æ–¹å¼äº¤æ¢æ¨¡æ€æ¡† -->
    <div id="contactExchangeModal" class="modal">
        <div class="modal-content">
            <h3>è”ç³»æ–¹å¼äº¤æ¢</h3>
            <p>å¾‹å¸ˆå·²æ¥å•ï¼Œç°åœ¨å¯ä»¥äº¤æ¢è”ç³»æ–¹å¼è¿›è¡Œåç»­æ²Ÿé€šï¼š</p>
            <div>
                <label>æ‚¨çš„è”ç³»æ–¹å¼</label>
                <input type="text" id="userContactName" placeholder="å§“å">
                <input type="tel" id="userContactPhone" placeholder="ç”µè¯">
                <input type="email" id="userContactEmail" placeholder="é‚®ç®±">
                <textarea id="contactMessage" placeholder="ç•™è¨€"></textarea>
            </div>
            <div>
                <button onclick="submitContactExchange()">ç¡®è®¤äº¤æ¢</button>
                <button onclick="closeContactModal()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <script>
        let currentTaskId = null;
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            document.getElementById('testResults').appendChild(div);
            console.log(message);
        }
        
        function testViewTaskDetails() {
            try {
                // æ¨¡æ‹Ÿè°ƒç”¨viewTaskDetailså‡½æ•°
                log('âœ… è°ƒç”¨viewTaskDetails("test-task-001")', 'success');
                viewTaskDetails('test-task-001');
            } catch (error) {
                log(`âŒ viewTaskDetailså‡½æ•°é”™è¯¯: ${error.message}`, 'error');
            }
        }
        
        function testEditTask() {
            try {
                log('âœ… è°ƒç”¨editTask("test-task-001")', 'success');
                editTask('test-task-001');
            } catch (error) {
                log(`âŒ editTaskå‡½æ•°é”™è¯¯: ${error.message}`, 'error');
            }
        }
        
        function testContactExchange() {
            try {
                log('âœ… è°ƒç”¨openContactExchange("test-task-001")', 'success');
                openContactExchange('test-task-001');
            } catch (error) {
                log(`âŒ openContactExchangeå‡½æ•°é”™è¯¯: ${error.message}`, 'error');
            }
        }
        
        // æ¨¡æ‹Ÿç”¨æˆ·å·¥ä½œå°çš„æ ¸å¿ƒå‡½æ•°
        function viewTaskDetails(taskId) {
            log(`æŸ¥çœ‹ä»»åŠ¡è¯¦æƒ…: ${taskId}`, 'success');
            
            // åˆ›å»ºè¯¦æƒ…å¼¹çª—
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = \`
                <div class="modal-content">
                    <h3>ä»»åŠ¡è¯¦æƒ…</h3>
                    <p>ä»»åŠ¡ID: \${taskId}</p>
                    <p>è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ä»»åŠ¡çš„è¯¦æƒ…å†…å®¹...</p>
                    <button onclick="this.closest('.modal').remove()">å…³é—­</button>
                </div>
            \`;
            document.body.appendChild(modal);
        }
        
        function editTask(taskId) {
            log(`ç¼–è¾‘ä»»åŠ¡: ${taskId}`, 'success');
            
            // åˆ›å»ºç¼–è¾‘å¼¹çª—
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            modal.innerHTML = \`
                <div class="modal-content">
                    <h3>ç¼–è¾‘ä»»åŠ¡</h3>
                    <p>ä»»åŠ¡ID: \${taskId}</p>
                    <form>
                        <label>ä»»åŠ¡æ ‡é¢˜:</label>
                        <input type="text" value="æµ‹è¯•ä»»åŠ¡" style="width: 100%; margin: 5px 0;">
                        <label>ä»»åŠ¡æè¿°:</label>
                        <textarea style="width: 100%; margin: 5px 0;">æµ‹è¯•æè¿°</textarea>
                        <label>é¢„ç®—:</label>
                        <input type="number" value="1000" style="width: 100%; margin: 5px 0;">
                    </form>
                    <div style="margin-top: 15px;">
                        <button onclick="alert('ä¿å­˜æˆåŠŸ'); this.closest('.modal').remove()">ä¿å­˜</button>
                        <button onclick="this.closest('.modal').remove()">å–æ¶ˆ</button>
                    </div>
                </div>
            \`;
            document.body.appendChild(modal);
        }
        
        function openContactExchange(taskId) {
            currentTaskId = taskId;
            log(`æ‰“å¼€è”ç³»æ–¹å¼äº¤æ¢: ${taskId}`, 'success');
            document.getElementById('contactExchangeModal').style.display = 'block';
        }
        
        function closeContactModal() {
            document.getElementById('contactExchangeModal').style.display = 'none';
            currentTaskId = null;
            log('å…³é—­è”ç³»æ–¹å¼äº¤æ¢æ¨¡æ€æ¡†', 'success');
        }
        
        function submitContactExchange() {
            const name = document.getElementById('userContactName').value;
            const phone = document.getElementById('userContactPhone').value;
            const email = document.getElementById('userContactEmail').value;
            
            if (!name || !phone) {
                alert('è¯·å¡«å†™å§“åå’Œè”ç³»ç”µè¯');
                return;
            }
            
            log(`æäº¤è”ç³»æ–¹å¼äº¤æ¢: ${name}, ${phone}, ${email}`, 'success');
            alert('è”ç³»æ–¹å¼äº¤æ¢æˆåŠŸï¼');
            closeContactModal();
        }
        
        // é¡µé¢åŠ è½½åæ˜¾ç¤ºçŠ¶æ€
        document.addEventListener('DOMContentLoaded', function() {
            log('é¡µé¢åŠ è½½å®Œæˆï¼Œå‡†å¤‡æµ‹è¯•åŠŸèƒ½æŒ‰é’®', 'success');
            log('ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æµ‹è¯•å„é¡¹åŠŸèƒ½', 'info');
        });
    </script>
</body>
</html>