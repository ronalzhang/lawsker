# Lawsker系统架构文档

## 📋 目录

- [系统概述](#系统概述)
- [技术栈](#技术栈)
- [架构设计](#架构设计)
- [模块说明](#模块说明)
- [数据流](#数据流)
- [部署架构](#部署架构)
- [安全架构](#安全架构)
- [性能优化](#性能优化)

## 🎯 系统概述

Lawsker（律思客）是一个法律服务O2O平台，为用户和律师提供在线法律咨询、案件管理、支付结算等服务。

### 核心功能
- 用户注册和认证
- 律师认证和管理
- 案件发布和匹配
- 在线咨询和沟通
- 支付和结算
- 数据分析和报表

### 系统特点
- 微服务架构
- 前后端分离
- 实时通信
- 数据驱动
- 高可用性
- 安全可靠

## 🛠️ 技术栈

### 后端技术栈
- **框架**: FastAPI (Python 3.11)
- **数据库**: PostgreSQL 14
- **缓存**: Redis 7
- **消息队列**: Celery + Redis
- **搜索引擎**: Elasticsearch
- **文件存储**: MinIO
- **监控**: Prometheus + Grafana
- **日志**: ELK Stack

### 前端技术栈
- **用户端**: Vue.js 3 + TypeScript + Vite
- **管理后台**: Vue.js 3 + TypeScript + Element Plus
- **状态管理**: Pinia
- **路由**: Vue Router 4
- **HTTP客户端**: Axios
- **图表**: ECharts
- **实时通信**: Socket.IO

### 基础设施
- **容器化**: Docker + Docker Compose
- **反向代理**: NGINX
- **SSL证书**: Let's Encrypt
- **CI/CD**: GitHub Actions
- **服务器**: 阿里云ECS (156.236.74.200)
- **进程管理**: PM2## 
🏗️ 架构设计

### 整体架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    Lawsker系统架构                          │
├─────────────────────────────────────────────────────────────┤
│  客户端层 (Client Layer)                                    │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │   Web浏览器      │  │   移动端浏览器   │  │   管理后台       ││
│  │  Vue.js 3 SPA   │  │  响应式设计      │  │  Element Plus   ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  网关层 (Gateway Layer)                                     │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  NGINX (负载均衡 + SSL终端 + 静态资源)                  │ │
│  └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  应用层 (Application Layer)                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │   用户服务       │  │   律师服务       │  │   案件服务       ││
│  │  FastAPI        │  │  FastAPI        │  │  FastAPI        ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │   支付服务       │  │   通知服务       │  │   文件服务       ││
│  │  FastAPI        │  │  WebSocket      │  │  MinIO          ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  数据层 (Data Layer)                                        │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐│
│  │   PostgreSQL    │  │   Redis         │  │   Elasticsearch ││
│  │  主数据库       │  │  缓存+会话      │  │  搜索引擎       ││
│  └─────────────────┘  └─────────────────┘  └─────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  监控层 (Monitoring Layer)                                  │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  Prometheus + Grafana + ELK Stack                      │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### 微服务架构

#### 服务划分
1. **用户服务** (User Service)
   - 用户注册、登录、认证
   - 用户信息管理
   - 权限控制

2. **律师服务** (Lawyer Service)
   - 律师认证和审核
   - 律师信息管理
   - 专业领域管理

3. **案件服务** (Case Service)
   - 案件发布和管理
   - 案件分配和匹配
   - 案件状态跟踪

4. **支付服务** (Payment Service)
   - 支付处理
   - 订单管理
   - 结算和分账

5. **通知服务** (Notification Service)
   - 实时消息推送
   - 邮件通知
   - 短信通知

6. **文件服务** (File Service)
   - 文件上传和下载
   - 文件存储管理
   - 图片处理

### 数据库设计

#### 核心表结构
- **users**: 用户基础信息
- **lawyers**: 律师信息和认证
- **cases**: 案件信息
- **orders**: 订单和支付
- **messages**: 消息和通信
- **files**: 文件管理
- **logs**: 系统日志

#### 数据库优化
- 读写分离
- 分库分表
- 索引优化
- 查询缓存