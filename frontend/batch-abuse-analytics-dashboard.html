<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>批量任务滥用分析仪表盘 - Lawsker</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <!-- 专业图标系统 -->
    <script src="/js/icon-system.js"></script>
    <script src="/js/professional-icon-library.js"></script>
    <script src="/js/icon-upgrade-system.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.35s;
            transform-origin: 50% 50%;
        }
        
        .metric-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
        }
        
        .success-gradient {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .warning-gradient {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .danger-gradient {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .info-gradient {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 导航栏 -->
    <nav class="gradient-bg shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-white text-xl font-bold">
                            <i class="fas fa-shield-alt mr-2"></i>
                            批量任务滥用分析
                        </h1>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="refreshBtn" class="text-white hover:text-gray-200 transition-colors">
                        <i class="fas fa-sync-alt"></i>
                        刷新数据
                    </button>
                    <div class="text-white text-sm">
                        最后更新: <span id="lastUpdate">--</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- 90%减少目标进度卡片 -->
        <div class="mb-8">
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <i class="fas fa-target text-blue-600 mr-2"></i>
                        90%滥用减少目标进度
                    </h2>
                    <div id="targetStatus" class="px-4 py-2 rounded-full text-sm font-medium">
                        加载中...
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- 进度环形图 -->
                    <div class="flex justify-center items-center">
                        <div class="relative w-32 h-32">
                            <svg class="w-32 h-32 progress-ring">
                                <circle
                                    class="text-gray-200"
                                    stroke-width="8"
                                    stroke="currentColor"
                                    fill="transparent"
                                    r="56"
                                    cx="64"
                                    cy="64"/>
                                <circle
                                    id="progressCircle"
                                    class="text-blue-600 progress-ring-circle"
                                    stroke-width="8"
                                    stroke-dasharray="351.86"
                                    stroke-dashoffset="351.86"
                                    stroke-linecap="round"
                                    stroke="currentColor"
                                    fill="transparent"
                                    r="56"
                                    cx="64"
                                    cy="64"/>
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <span id="progressText" class="text-2xl font-bold text-gray-800">0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 关键指标 -->
                    <div class="col-span-2 grid grid-cols-2 gap-4">
                        <div class="metric-card rounded-lg p-4">
                            <div class="text-sm text-gray-600 mb-1">目标减少率</div>
                            <div id="targetReduction" class="text-2xl font-bold text-blue-600">90%</div>
                        </div>
                        <div class="metric-card rounded-lg p-4">
                            <div class="text-sm text-gray-600 mb-1">实际减少率</div>
                            <div id="actualReduction" class="text-2xl font-bold text-green-600">--</div>
                        </div>
                        <div class="metric-card rounded-lg p-4">
                            <div class="text-sm text-gray-600 mb-1">Credits阻止滥用</div>
                            <div id="creditsPreventedAbuse" class="text-2xl font-bold text-purple-600">--</div>
                        </div>
                        <div class="metric-card rounded-lg p-4">
                            <div class="text-sm text-gray-600 mb-1">成本节省</div>
                            <div id="costSavings" class="text-2xl font-bold text-orange-600">--</div>
                        </div>
                    </div>
                </div>
                
                <!-- 改进建议 -->
                <div class="mt-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">改进建议</h3>
                    <div id="recommendations" class="space-y-2">
                        <!-- 建议将动态加载 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 统计卡片网格 -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- 总体滥用率 -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full info-gradient">
                        <i class="fas fa-chart-line text-white text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">当前滥用率</p>
                        <p id="currentAbuseRate" class="text-2xl font-bold text-gray-900">--</p>
                    </div>
                </div>
            </div>

            <!-- Credits效果评分 -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full success-gradient">
                        <i class="fas fa-star text-white text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Credits效果评分</p>
                        <p id="creditsEffectivenessScore" class="text-2xl font-bold text-gray-900">--</p>
                    </div>
                </div>
            </div>

            <!-- 本月阻止滥用 -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full warning-gradient">
                        <i class="fas fa-shield-alt text-white text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">本月阻止滥用</p>
                        <p id="monthlyPreventedAbuse" class="text-2xl font-bold text-gray-900">--</p>
                    </div>
                </div>
            </div>

            <!-- Credits收入 -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <div class="flex items-center">
                    <div class="p-3 rounded-full danger-gradient">
                        <i class="fas fa-coins text-white text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Credits收入</p>
                        <p id="creditsRevenue" class="text-2xl font-bold text-gray-900">--</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 图表区域 -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- 滥用趋势图 -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">
                    <i class="fas fa-chart-area text-blue-600 mr-2"></i>
                    滥用率趋势 (30天)
                </h3>
                <div class="h-64">
                    <canvas id="abuseTrendChart"></canvas>
                </div>
            </div>

            <!-- Credits使用分析 -->
            <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">
                    <i class="fas fa-pie-chart text-green-600 mr-2"></i>
                    Credits使用分析
                </h3>
                <div class="h-64">
                    <canvas id="creditsUsageChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 详细数据表格 -->
        <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-800">
                    <i class="fas fa-table text-purple-600 mr-2"></i>
                    滥用检测详情
                </h3>
                <div class="flex space-x-2">
                    <select id="periodSelect" class="border border-gray-300 rounded-md px-3 py-2 text-sm">
                        <option value="7">最近7天</option>
                        <option value="30" selected>最近30天</option>
                        <option value="90">最近90天</option>
                    </select>
                    <button id="exportBtn" class="bg-blue-600 text-white px-4 py-2 rounded-md text-sm hover:bg-blue-700 transition-colors">
                        <i class="fas fa-download mr-1"></i>
                        导出数据
                    </button>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">日期</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">总上传数</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">滥用上传数</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">滥用率</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Credits阻止</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                        </tr>
                    </thead>
                    <tbody id="detailsTableBody" class="bg-white divide-y divide-gray-200">
                        <!-- 数据将动态加载 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 加载遮罩 -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 flex items-center space-x-3">
            <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
            <span class="text-gray-700">加载数据中...</span>
        </div>
    </div>

    <script>
        class AbuseAnalyticsDashboard {
            constructor() {
                this.apiBase = '/api/v1/abuse-analytics';
                this.charts = {};
                this.data = {};
                
                this.init();
            }
            
            async init() {
                this.bindEvents();
                await this.loadAllData();
                this.hideLoading();
                this.updateLastUpdateTime();
            }
            
            bindEvents() {
                document.getElementById('refreshBtn').addEventListener('click', () => {
                    this.refreshData();
                });
                
                document.getElementById('periodSelect').addEventListener('change', (e) => {
                    this.loadTrendData(parseInt(e.target.value));
                });
                
                document.getElementById('exportBtn').addEventListener('click', () => {
                    this.exportData();
                });
            }
            
            async loadAllData() {
                try {
                    // 并行加载所有数据
                    const [progressData, trendsData, effectivenessData] = await Promise.all([
                        this.fetchData('/abuse-reduction-progress'),
                        this.fetchData('/abuse-trends?days=30'),
                        this.fetchData('/credits-effectiveness')
                    ]);
                    
                    this.data.progress = progressData;
                    this.data.trends = trendsData;
                    this.data.effectiveness = effectivenessData;
                    
                    this.updateProgressCard();
                    this.updateStatCards();
                    this.updateCharts();
                    this.updateDetailsTable();
                    
                } catch (error) {
                    console.error('加载数据失败:', error);
                    this.showError('数据加载失败，请稍后重试');
                }
            }
            
            async fetchData(endpoint) {
                const response = await fetch(`${this.apiBase}${endpoint}`, {
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('token')}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                return result.data;
            }
            
            updateProgressCard() {
                const progress = this.data.progress;
                if (!progress) return;
                
                // 更新进度环
                const targetAchievement = progress.target_achievement_rate || 0;
                const progressPercentage = Math.min(100, targetAchievement * 100);
                
                this.updateProgressRing(progressPercentage);
                document.getElementById('progressText').textContent = `${Math.round(progressPercentage)}%`;
                
                // 更新状态标签
                const statusEl = document.getElementById('targetStatus');
                if (progress.target_achieved) {
                    statusEl.textContent = '目标已达成';
                    statusEl.className = 'px-4 py-2 rounded-full text-sm font-medium bg-green-100 text-green-800';
                } else if (progressPercentage >= 80) {
                    statusEl.textContent = '接近目标';
                    statusEl.className = 'px-4 py-2 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800';
                } else {
                    statusEl.textContent = '努力中';
                    statusEl.className = 'px-4 py-2 rounded-full text-sm font-medium bg-blue-100 text-blue-800';
                }
                
                // 更新关键指标
                document.getElementById('actualReduction').textContent = 
                    `${Math.round((progress.actual_reduction || 0) * 100)}%`;
                document.getElementById('creditsPreventedAbuse').textContent = 
                    progress.credits_impact?.prevented_abuse || 0;
                document.getElementById('costSavings').textContent = 
                    `¥${(progress.credits_impact?.cost_savings || 0).toLocaleString()}`;
                
                // 更新建议
                this.updateRecommendations(progress.recommendations || []);
            }
            
            updateProgressRing(percentage) {
                const circle = document.getElementById('progressCircle');
                const circumference = 2 * Math.PI * 56; // r = 56
                const offset = circumference - (percentage / 100) * circumference;
                
                circle.style.strokeDashoffset = offset;
                
                // 根据进度改变颜色
                if (percentage >= 90) {
                    circle.classList.remove('text-blue-600', 'text-yellow-500');
                    circle.classList.add('text-green-500');
                } else if (percentage >= 70) {
                    circle.classList.remove('text-blue-600', 'text-green-500');
                    circle.classList.add('text-yellow-500');
                } else {
                    circle.classList.remove('text-green-500', 'text-yellow-500');
                    circle.classList.add('text-blue-600');
                }
            }
            
            updateRecommendations(recommendations) {
                const container = document.getElementById('recommendations');
                container.innerHTML = '';
                
                if (recommendations.length === 0) {
                    container.innerHTML = '<p class="text-gray-500 text-sm">暂无建议</p>';
                    return;
                }
                
                recommendations.forEach(rec => {
                    const div = document.createElement('div');
                    div.className = 'flex items-center space-x-2 text-sm';
                    div.innerHTML = `
                        <i class="fas fa-lightbulb text-yellow-500"></i>
                        <span class="text-gray-700">${rec}</span>
                    `;
                    container.appendChild(div);
                });
            }
            
            updateStatCards() {
                const trends = this.data.trends;
                const effectiveness = this.data.effectiveness;
                
                if (trends?.summary) {
                    document.getElementById('currentAbuseRate').textContent = 
                        `${trends.summary.recent_7_days_avg_abuse_rate}%`;
                }
                
                if (effectiveness?.effectiveness_score) {
                    const score = effectiveness.effectiveness_score;
                    document.getElementById('creditsEffectivenessScore').textContent = 
                        `${score.total_score} (${score.grade})`;
                }
                
                if (effectiveness?.abuse_prevention) {
                    document.getElementById('monthlyPreventedAbuse').textContent = 
                        effectiveness.abuse_prevention.estimated_abuse_prevented;
                }
                
                if (effectiveness?.revenue_impact) {
                    document.getElementById('creditsRevenue').textContent = 
                        `¥${effectiveness.revenue_impact.total_credits_revenue.toLocaleString()}`;
                }
            }
            
            updateCharts() {
                this.updateAbuseTrendChart();
                this.updateCreditsUsageChart();
            }
            
            updateAbuseTrendChart() {
                const ctx = document.getElementById('abuseTrendChart').getContext('2d');
                const trends = this.data.trends;
                
                if (this.charts.abuseTrend) {
                    this.charts.abuseTrend.destroy();
                }
                
                if (!trends?.trend_data) return;
                
                const labels = trends.trend_data.map(d => {
                    const date = new Date(d.date);
                    return `${date.getMonth() + 1}/${date.getDate()}`;
                });
                
                const abuseRates = trends.trend_data.map(d => d.abuse_rate);
                const totalUploads = trends.trend_data.map(d => d.total_uploads);
                
                this.charts.abuseTrend = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '滥用率 (%)',
                            data: abuseRates,
                            borderColor: 'rgb(239, 68, 68)',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.4,
                            yAxisID: 'y'
                        }, {
                            label: '总上传数',
                            data: totalUploads,
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            yAxisID: 'y1'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        scales: {
                            x: {
                                display: true,
                                title: {
                                    display: true,
                                    text: '日期'
                                }
                            },
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: '滥用率 (%)'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: '上传数'
                                },
                                grid: {
                                    drawOnChartArea: false,
                                }
                            }
                        }
                    }
                });
            }
            
            updateCreditsUsageChart() {
                const ctx = document.getElementById('creditsUsageChart').getContext('2d');
                const effectiveness = this.data.effectiveness;
                
                if (this.charts.creditsUsage) {
                    this.charts.creditsUsage.destroy();
                }
                
                if (!effectiveness?.credits_usage) return;
                
                const usage = effectiveness.credits_usage;
                
                this.charts.creditsUsage = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['已使用', '剩余', '购买'],
                        datasets: [{
                            data: [
                                usage.total_credits_used,
                                usage.average_credits_remaining * effectiveness.user_statistics.total_users_with_credits,
                                usage.total_credits_purchased
                            ],
                            backgroundColor: [
                                'rgb(239, 68, 68)',
                                'rgb(34, 197, 94)',
                                'rgb(59, 130, 246)'
                            ],
                            borderWidth: 2,
                            borderColor: '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
            
            updateDetailsTable() {
                const tbody = document.getElementById('detailsTableBody');
                const trends = this.data.trends;
                
                if (!trends?.trend_data) {
                    tbody.innerHTML = '<tr><td colspan="6" class="text-center py-4 text-gray-500">暂无数据</td></tr>';
                    return;
                }
                
                tbody.innerHTML = '';
                
                trends.trend_data.forEach(day => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50';
                    
                    const abuseLevel = this.getAbuseLevel(day.abuse_rate);
                    const statusClass = this.getStatusClass(abuseLevel);
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${day.date}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${day.total_uploads}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${day.abusive_uploads}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${day.abuse_rate}%</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${day.credits_prevented}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass}">
                                ${abuseLevel}
                            </span>
                        </td>
                    `;
                    
                    tbody.appendChild(row);
                });
            }
            
            getAbuseLevel(rate) {
                if (rate < 5) return '良好';
                if (rate < 15) return '一般';
                if (rate < 30) return '较高';
                return '严重';
            }
            
            getStatusClass(level) {
                switch (level) {
                    case '良好': return 'bg-green-100 text-green-800';
                    case '一般': return 'bg-yellow-100 text-yellow-800';
                    case '较高': return 'bg-orange-100 text-orange-800';
                    case '严重': return 'bg-red-100 text-red-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            }
            
            async refreshData() {
                this.showLoading();
                await this.loadAllData();
                this.hideLoading();
                this.updateLastUpdateTime();
                this.showSuccess('数据已刷新');
            }
            
            async loadTrendData(days) {
                try {
                    const trendsData = await this.fetchData(`/abuse-trends?days=${days}`);
                    this.data.trends = trendsData;
                    this.updateAbuseTrendChart();
                    this.updateDetailsTable();
                } catch (error) {
                    console.error('加载趋势数据失败:', error);
                    this.showError('加载趋势数据失败');
                }
            }
            
            exportData() {
                const trends = this.data.trends;
                if (!trends?.trend_data) {
                    this.showError('暂无数据可导出');
                    return;
                }
                
                // 创建CSV内容
                const headers = ['日期', '总上传数', '滥用上传数', '滥用率(%)', 'Credits阻止', '状态'];
                const csvContent = [
                    headers.join(','),
                    ...trends.trend_data.map(day => [
                        day.date,
                        day.total_uploads,
                        day.abusive_uploads,
                        day.abuse_rate,
                        day.credits_prevented,
                        this.getAbuseLevel(day.abuse_rate)
                    ].join(','))
                ].join('\n');
                
                // 下载文件
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `abuse_analytics_${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                this.showSuccess('数据导出成功');
            }
            
            showLoading() {
                document.getElementById('loadingOverlay').classList.remove('hidden');
            }
            
            hideLoading() {
                document.getElementById('loadingOverlay').classList.add('hidden');
            }
            
            updateLastUpdateTime() {
                document.getElementById('lastUpdate').textContent = 
                    new Date().toLocaleString('zh-CN');
            }
            
            showSuccess(message) {
                // 简单的成功提示
                const toast = document.createElement('div');
                toast.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 3000);
            }
            
            showError(message) {
                // 简单的错误提示
                const toast = document.createElement('div');
                toast.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                toast.textContent = message;
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 5000);
            }
        }
        
        // 初始化仪表盘
        document.addEventListener('DOMContentLoaded', () => {
            new AbuseAnalyticsDashboard();
        });
    </script>
</body>
</html>